/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e,n;!function(t){t.STRING="string",t.NUMBER="number",t.INTEGER="integer",t.BOOLEAN="boolean",t.ARRAY="array",t.OBJECT="object"}(t||(t={})),function(t){t.LANGUAGE_UNSPECIFIED="language_unspecified",t.PYTHON="python"}(e||(e={})),function(t){t.OUTCOME_UNSPECIFIED="outcome_unspecified",t.OUTCOME_OK="outcome_ok",t.OUTCOME_FAILED="outcome_failed",t.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"}(n||(n={}));const o=["user","model","function","system"];var r,s,i,a,c,u,l,d,h;!function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"}(r||(r={})),function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"}(s||(s={})),function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"}(i||(i={})),function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER"}(a||(a={})),function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER"}(c||(c={})),function(t){t.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",t.RETRIEVAL_QUERY="RETRIEVAL_QUERY",t.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",t.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",t.CLASSIFICATION="CLASSIFICATION",t.CLUSTERING="CLUSTERING"}(u||(u={})),function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"}(l||(l={})),function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"}(d||(d={}));class f extends Error{constructor(t){super(`[GoogleGenerativeAI Error]: ${t}`)}}class p extends f{constructor(t,e){super(t),this.response=e}}class g extends f{constructor(t,e,n,o){super(t),this.status=e,this.statusText=n,this.errorDetails=o}}class m extends f{}!function(t){t.GENERATE_CONTENT="generateContent",t.STREAM_GENERATE_CONTENT="streamGenerateContent",t.COUNT_TOKENS="countTokens",t.EMBED_CONTENT="embedContent",t.BATCH_EMBED_CONTENTS="batchEmbedContents"}(h||(h={}));class v{constructor(t,e,n,o,r){this.model=t,this.task=e,this.apiKey=n,this.stream=o,this.requestOptions=r}toString(){var t,e;const n=(null===(t=this.requestOptions)||void 0===t?void 0:t.apiVersion)||"v1beta";let o=`${(null===(e=this.requestOptions)||void 0===e?void 0:e.baseUrl)||"https://generativelanguage.googleapis.com"}/${n}/${this.model}:${this.task}`;return this.stream&&(o+="?alt=sse"),o}}async function y(t){var e;const n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",function(t){const e=[];return(null==t?void 0:t.apiClient)&&e.push(t.apiClient),e.push("genai-js/0.21.0"),e.join(" ")}(t.requestOptions)),n.append("x-goog-api-key",t.apiKey);let o=null===(e=t.requestOptions)||void 0===e?void 0:e.customHeaders;if(o){if(!(o instanceof Headers))try{o=new Headers(o)}catch(t){throw new m(`unable to convert customHeaders value ${JSON.stringify(o)} to Headers: ${t.message}`)}for(const[t,e]of o.entries()){if("x-goog-api-key"===t)throw new m(`Cannot set reserved header name ${t}`);if("x-goog-api-client"===t)throw new m(`Header name ${t} can only be set using the apiClient field`);n.append(t,e)}}return n}async function E(t,e,n,o,r,s={},i=fetch){const{url:a,fetchOptions:c}=await async function(t,e,n,o,r,s){const i=new v(t,e,n,o,s);return{url:i.toString(),fetchOptions:Object.assign(Object.assign({},C(s)),{method:"POST",headers:await y(i),body:r})}}(t,e,n,o,r,s);return async function(t,e,n=fetch){let o;try{o=await n(t,e)}catch(e){!function(t,e){let n=t;throw t instanceof g||t instanceof m||(n=new f(`Error fetching from ${e.toString()}: ${t.message}`),n.stack=t.stack),n}(e,t)}return o.ok||await async function(t,e){let n,o="";try{const e=await t.json();o=e.error.message,e.error.details&&(o+=` ${JSON.stringify(e.error.details)}`,n=e.error.details)}catch(t){}throw new g(`Error fetching from ${e.toString()}: [${t.status} ${t.statusText}] ${o}`,t.status,t.statusText,n)}(o,t),o}(a,c,i)}function C(t){const e={};if(void 0!==(null==t?void 0:t.signal)||(null==t?void 0:t.timeout)>=0){const n=new AbortController;(null==t?void 0:t.timeout)>=0&&setTimeout((()=>n.abort()),t.timeout),(null==t?void 0:t.signal)&&t.signal.addEventListener("abort",(()=>{n.abort()})),e.signal=n.signal}return e}function w(t){return t.text=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),_(t.candidates[0]))throw new p(`${T(t)}`,t);return function(t){var e,n,o,r;const s=[];if(null===(n=null===(e=t.candidates)||void 0===e?void 0:e[0].content)||void 0===n?void 0:n.parts)for(const e of null===(r=null===(o=t.candidates)||void 0===o?void 0:o[0].content)||void 0===r?void 0:r.parts)e.text&&s.push(e.text),e.executableCode&&s.push("\n```"+e.executableCode.language+"\n"+e.executableCode.code+"\n```\n"),e.codeExecutionResult&&s.push("\n```\n"+e.codeExecutionResult.output+"\n```\n");return s.length>0?s.join(""):""}(t)}if(t.promptFeedback)throw new p(`Text not available. ${T(t)}`,t);return""},t.functionCall=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),_(t.candidates[0]))throw new p(`${T(t)}`,t);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),O(t)[0]}if(t.promptFeedback)throw new p(`Function call not available. ${T(t)}`,t)},t.functionCalls=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),_(t.candidates[0]))throw new p(`${T(t)}`,t);return O(t)}if(t.promptFeedback)throw new p(`Function call not available. ${T(t)}`,t)},t}function O(t){var e,n,o,r;const s=[];if(null===(n=null===(e=t.candidates)||void 0===e?void 0:e[0].content)||void 0===n?void 0:n.parts)for(const e of null===(r=null===(o=t.candidates)||void 0===o?void 0:o[0].content)||void 0===r?void 0:r.parts)e.functionCall&&s.push(e.functionCall);return s.length>0?s:void 0}const b=[c.RECITATION,c.SAFETY,c.LANGUAGE];function _(t){return!!t.finishReason&&b.includes(t.finishReason)}function T(t){var e,n,o;let r="";if(t.candidates&&0!==t.candidates.length||!t.promptFeedback){if(null===(o=t.candidates)||void 0===o?void 0:o[0]){const e=t.candidates[0];_(e)&&(r+=`Candidate was blocked due to ${e.finishReason}`,e.finishMessage&&(r+=`: ${e.finishMessage}`))}}else r+="Response was blocked",(null===(e=t.promptFeedback)||void 0===e?void 0:e.blockReason)&&(r+=` due to ${t.promptFeedback.blockReason}`),(null===(n=t.promptFeedback)||void 0===n?void 0:n.blockReasonMessage)&&(r+=`: ${t.promptFeedback.blockReasonMessage}`);return r}function I(t){return this instanceof I?(this.v=t,this):new I(t)}"function"==typeof SuppressedError&&SuppressedError;const S=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;async function N(t){const e=[],n=t.getReader();for(;;){const{done:t,value:o}=await n.read();if(t)return w(x(e));e.push(o)}}function A(t){return function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(t,e||[]),s=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(t){r[t]&&(o[t]=function(e){return new Promise((function(n,o){s.push([t,e,n,o])>1||a(t,e)}))})}function a(t,e){try{(n=r[t](e)).value instanceof I?Promise.resolve(n.value.v).then(c,u):l(s[0][2],n)}catch(t){l(s[0][3],t)}var n}function c(t){a("next",t)}function u(t){a("throw",t)}function l(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,(function*(){const e=t.getReader();for(;;){const{value:t,done:n}=yield I(e.read());if(n)break;yield yield I(w(t))}}))}function x(t){const e=t[t.length-1],n={promptFeedback:null==e?void 0:e.promptFeedback};for(const e of t){if(e.candidates)for(const t of e.candidates){const e=t.index;if(n.candidates||(n.candidates=[]),n.candidates[e]||(n.candidates[e]={index:t.index}),n.candidates[e].citationMetadata=t.citationMetadata,n.candidates[e].groundingMetadata=t.groundingMetadata,n.candidates[e].finishReason=t.finishReason,n.candidates[e].finishMessage=t.finishMessage,n.candidates[e].safetyRatings=t.safetyRatings,t.content&&t.content.parts){n.candidates[e].content||(n.candidates[e].content={role:t.content.role||"user",parts:[]});const o={};for(const r of t.content.parts)r.text&&(o.text=r.text),r.functionCall&&(o.functionCall=r.functionCall),r.executableCode&&(o.executableCode=r.executableCode),r.codeExecutionResult&&(o.codeExecutionResult=r.codeExecutionResult),0===Object.keys(o).length&&(o.text=""),n.candidates[e].content.parts.push(o)}}e.usageMetadata&&(n.usageMetadata=e.usageMetadata)}return n}async function R(t,e,n,o){return function(t){const e=function(t){const e=t.getReader();return new ReadableStream({start(t){let n="";return function o(){return e.read().then((({value:e,done:r})=>{if(r)return n.trim()?void t.error(new f("Failed to parse stream")):void t.close();n+=e;let s,i=n.match(S);for(;i;){try{s=JSON.parse(i[1])}catch(e){return void t.error(new f(`Error parsing JSON response: "${i[1]}"`))}t.enqueue(s),n=n.substring(i[0].length),i=n.match(S)}return o()}))}()}})}(t.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0}))),[n,o]=e.tee();return{stream:A(n),response:N(o)}}(await E(e,h.STREAM_GENERATE_CONTENT,t,!0,JSON.stringify(n),o))}async function L(t,e,n,o){const r=await E(e,h.GENERATE_CONTENT,t,!1,JSON.stringify(n),o);return{response:w(await r.json())}}function M(t){if(null!=t)return"string"==typeof t?{role:"system",parts:[{text:t}]}:t.text?{role:"system",parts:[t]}:t.parts?t.role?t:{role:"system",parts:t.parts}:void 0}function j(t){let e=[];if("string"==typeof t)e=[{text:t}];else for(const n of t)"string"==typeof n?e.push({text:n}):e.push(n);return function(t){const e={role:"user",parts:[]},n={role:"function",parts:[]};let o=!1,r=!1;for(const s of t)"functionResponse"in s?(n.parts.push(s),r=!0):(e.parts.push(s),o=!0);if(o&&r)throw new f("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!o&&!r)throw new f("No content is provided for sending chat message.");return o?e:n}(e)}function D(t){let e;return e=t.contents?t:{contents:[j(t)]},t.systemInstruction&&(e.systemInstruction=M(t.systemInstruction)),e}const P=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],k={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]},F="SILENT_ERROR";class G{constructor(t,e,n,r={}){this.model=e,this.params=n,this._requestOptions=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=t,(null==n?void 0:n.history)&&(function(t){let e=!1;for(const n of t){const{role:t,parts:r}=n;if(!e&&"user"!==t)throw new f(`First content should be with role 'user', got ${t}`);if(!o.includes(t))throw new f(`Each item should include role field. Got ${t} but valid roles are: ${JSON.stringify(o)}`);if(!Array.isArray(r))throw new f("Content should have 'parts' property with an array of Parts");if(0===r.length)throw new f("Each Content should have at least one part");const s={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const t of r)for(const e of P)e in t&&(s[e]+=1);const i=k[t];for(const e of P)if(!i.includes(e)&&s[e]>0)throw new f(`Content with role '${t}' can't contain '${e}' part`);e=!0}}(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(t,e={}){var n,o,r,s,i,a;await this._sendPromise;const c=j(t),u={safetySettings:null===(n=this.params)||void 0===n?void 0:n.safetySettings,generationConfig:null===(o=this.params)||void 0===o?void 0:o.generationConfig,tools:null===(r=this.params)||void 0===r?void 0:r.tools,toolConfig:null===(s=this.params)||void 0===s?void 0:s.toolConfig,systemInstruction:null===(i=this.params)||void 0===i?void 0:i.systemInstruction,cachedContent:null===(a=this.params)||void 0===a?void 0:a.cachedContent,contents:[...this._history,c]},l=Object.assign(Object.assign({},this._requestOptions),e);let d;return this._sendPromise=this._sendPromise.then((()=>L(this._apiKey,this.model,u,l))).then((t=>{var e;if(t.response.candidates&&t.response.candidates.length>0){this._history.push(c);const n=Object.assign({parts:[],role:"model"},null===(e=t.response.candidates)||void 0===e?void 0:e[0].content);this._history.push(n)}else{const e=T(t.response);e&&console.warn(`sendMessage() was unsuccessful. ${e}. Inspect response object for details.`)}d=t})),await this._sendPromise,d}async sendMessageStream(t,e={}){var n,o,r,s,i,a;await this._sendPromise;const c=j(t),u={safetySettings:null===(n=this.params)||void 0===n?void 0:n.safetySettings,generationConfig:null===(o=this.params)||void 0===o?void 0:o.generationConfig,tools:null===(r=this.params)||void 0===r?void 0:r.tools,toolConfig:null===(s=this.params)||void 0===s?void 0:s.toolConfig,systemInstruction:null===(i=this.params)||void 0===i?void 0:i.systemInstruction,cachedContent:null===(a=this.params)||void 0===a?void 0:a.cachedContent,contents:[...this._history,c]},l=Object.assign(Object.assign({},this._requestOptions),e),d=R(this._apiKey,this.model,u,l);return this._sendPromise=this._sendPromise.then((()=>d)).catch((t=>{throw new Error(F)})).then((t=>t.response)).then((t=>{if(t.candidates&&t.candidates.length>0){this._history.push(c);const e=Object.assign({},t.candidates[0].content);e.role||(e.role="model"),this._history.push(e)}else{const e=T(t);e&&console.warn(`sendMessageStream() was unsuccessful. ${e}. Inspect response object for details.`)}})).catch((t=>{t.message!==F&&console.error(t)})),d}}class H{constructor(t,e,n={}){this.apiKey=t,this._requestOptions=n,e.model.includes("/")?this.model=e.model:this.model=`models/${e.model}`,this.generationConfig=e.generationConfig||{},this.safetySettings=e.safetySettings||[],this.tools=e.tools,this.toolConfig=e.toolConfig,this.systemInstruction=M(e.systemInstruction),this.cachedContent=e.cachedContent}async generateContent(t,e={}){var n;const o=D(t),r=Object.assign(Object.assign({},this._requestOptions),e);return L(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(n=this.cachedContent)||void 0===n?void 0:n.name},o),r)}async generateContentStream(t,e={}){var n;const o=D(t),r=Object.assign(Object.assign({},this._requestOptions),e);return R(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(n=this.cachedContent)||void 0===n?void 0:n.name},o),r)}startChat(t){var e;return new G(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(e=this.cachedContent)||void 0===e?void 0:e.name},t),this._requestOptions)}async countTokens(t,e={}){const n=function(t,e){var n;let o={model:null==e?void 0:e.model,generationConfig:null==e?void 0:e.generationConfig,safetySettings:null==e?void 0:e.safetySettings,tools:null==e?void 0:e.tools,toolConfig:null==e?void 0:e.toolConfig,systemInstruction:null==e?void 0:e.systemInstruction,cachedContent:null===(n=null==e?void 0:e.cachedContent)||void 0===n?void 0:n.name,contents:[]};const r=null!=t.generateContentRequest;if(t.contents){if(r)throw new m("CountTokensRequest must have one of contents or generateContentRequest, not both.");o.contents=t.contents}else if(r)o=Object.assign(Object.assign({},o),t.generateContentRequest);else{const e=j(t);o.contents=[e]}return{generateContentRequest:o}}(t,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),o=Object.assign(Object.assign({},this._requestOptions),e);return async function(t,e,n,o){return(await E(e,h.COUNT_TOKENS,t,!1,JSON.stringify(n),o)).json()}(this.apiKey,this.model,n,o)}async embedContent(t,e={}){const n="string"==typeof(r=t)||Array.isArray(r)?{content:j(r)}:r,o=Object.assign(Object.assign({},this._requestOptions),e);var r;return async function(t,e,n,o){return(await E(e,h.EMBED_CONTENT,t,!1,JSON.stringify(n),o)).json()}(this.apiKey,this.model,n,o)}async batchEmbedContents(t,e={}){const n=Object.assign(Object.assign({},this._requestOptions),e);return async function(t,e,n,o){const r=n.requests.map((t=>Object.assign(Object.assign({},t),{model:e})));return(await E(e,h.BATCH_EMBED_CONTENTS,t,!1,JSON.stringify({requests:r}),o)).json()}(this.apiKey,this.model,t,n)}}const U=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/i,$="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36,gzip(gfe)",Y=/<text start="([^"]*)" dur="([^"]*)">([^<]*)<\/text>/g;class K extends Error{constructor(t){super(`[YoutubeTranscript] 🚨 ${t}`)}}class q extends K{constructor(){super("YouTube is receiving too many requests from this IP and now requires solving a captcha to continue")}}class B extends K{constructor(t){super(`The video is no longer available (${t})`)}}class J extends K{constructor(t){super(`Transcript is disabled on this video (${t})`)}}class z extends K{constructor(t){super(`No transcripts are available for this video (${t})`)}}class V extends K{constructor(t,e,n){super(`No transcripts are available in ${t} this video (${n}). Available languages: ${e.join(", ")}`)}}class X{static fetchTranscript(t,e){var n,o,r,s,i;return o=this,r=void 0,i=function*(){const o=this.retrieveVideoId(t),r=yield fetch(`https://www.youtube.com/watch?v=${o}`,{headers:Object.assign(Object.assign({},(null==e?void 0:e.lang)&&{"Accept-Language":e.lang}),{"User-Agent":$})}),s=yield r.text(),i=s.split('"captions":');if(i.length<=1){if(s.includes('class="g-recaptcha"'))throw new q;if(!s.includes('"playabilityStatus":'))throw new B(t);throw new J(t)}const a=null===(n=(()=>{try{return JSON.parse(i[1].split(',"videoDetails')[0].replace("\n",""))}catch(t){return}})())||void 0===n?void 0:n.playerCaptionsTracklistRenderer;if(!a)throw new J(t);if(!("captionTracks"in a))throw new z(t);if((null==e?void 0:e.lang)&&!a.captionTracks.some((t=>t.languageCode===(null==e?void 0:e.lang))))throw new V(null==e?void 0:e.lang,a.captionTracks.map((t=>t.languageCode)),t);const c=((null==e?void 0:e.lang)?a.captionTracks.find((t=>t.languageCode===(null==e?void 0:e.lang))):a.captionTracks[0]).baseUrl,u=yield fetch(c,{headers:Object.assign(Object.assign({},(null==e?void 0:e.lang)&&{"Accept-Language":e.lang}),{"User-Agent":$})});if(!u.ok)throw new z(t);return[...(yield u.text()).matchAll(Y)].map((t=>{var n;return{text:t[3],duration:parseFloat(t[2]),offset:parseFloat(t[1]),lang:null!==(n=null==e?void 0:e.lang)&&void 0!==n?n:a.captionTracks[0].languageCode}}))},new((s=void 0)||(s=Promise))((function(t,e){function n(t){try{c(i.next(t))}catch(t){e(t)}}function a(t){try{c(i.throw(t))}catch(t){e(t)}}function c(e){var o;e.done?t(e.value):(o=e.value,o instanceof s?o:new s((function(t){t(o)}))).then(n,a)}c((i=i.apply(o,r||[])).next())}))}static retrieveVideoId(t){if(11===t.length)return t;const e=t.match(U);if(e&&e.length)return e[1];throw new K("Impossible to retrieve Youtube video ID.")}}function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function Q(){Q=function(){return e};var t,e={},n=Object.prototype,o=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},i=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,o){var s=e&&e.prototype instanceof v?e:v,i=Object.create(s.prototype),a=new x(o||[]);return r(i,"_invoke",{value:I(t,n,a)}),i}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function v(){}function y(){}function E(){}var C={};u(C,i,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(R([])));O&&O!==n&&o.call(O,i)&&(C=O);var b=E.prototype=v.prototype=Object.create(C);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(r,s,i,a){var c=d(t[r],t,s);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==W(l)&&o.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}a(c.arg)}var s;r(this,"_invoke",{value:function(t,o){function r(){return new e((function(e,r){n(t,o,e,r)}))}return s=s?s.then(r,r):r()}})}function I(e,n,o){var r=h;return function(s,i){if(r===p)throw Error("Generator is already running");if(r===g){if("throw"===s)throw i;return{value:t,done:!0}}for(o.method=s,o.arg=i;;){var a=o.delegate;if(a){var c=S(a,o);if(c){if(c===m)continue;return c}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(r===h)throw r=g,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=p;var u=d(e,n,o);if("normal"===u.type){if(r=o.done?g:f,u.arg===m)continue;return{value:u.arg,done:o.done}}"throw"===u.type&&(r=g,o.method="throw",o.arg=u.arg)}}}function S(e,n){var o=n.method,r=e.iterator[o];if(r===t)return n.delegate=null,"throw"===o&&e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),m;var s=d(r,e.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,m;var i=s.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function R(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function n(){for(;++r<e.length;)if(o.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError(W(e)+" is not iterable")}return y.prototype=E,r(b,"constructor",{value:E,configurable:!0}),r(E,"constructor",{value:y,configurable:!0}),y.displayName=u(E,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,u(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},_(T.prototype),u(T.prototype,a,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,o,r,s){void 0===s&&(s=Promise);var i=new T(l(t,n,o,r),s);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},_(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var o in e)n.push(o);return n.reverse(),function t(){for(;n.length;){var o=n.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},e.values=R,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(o,r){return a.type="throw",a.arg=e,n.next=o,r&&(n.method="next",n.arg=t),!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var i=this.tryEntries[s],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var i=s?s.completion:{};return i.type=t,i.arg=e,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var r=o.arg;A(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={iterator:R(e),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=t),m}},e}function Z(t,e,n,o,r,s,i){try{var a=t[s](i),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(o,r)}function tt(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var s=t.apply(e,n);function i(t){Z(s,o,r,i,a,"next",t)}function a(t){Z(s,o,r,i,a,"throw",t)}i(void 0)}))}}console.log("Loaded");var et="",nt=" ",ot=new class{constructor(t){this.apiKey=t}getGenerativeModel(t,e){if(!t.model)throw new f("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new H(this.apiKey,t,e)}getGenerativeModelFromCachedContent(t,e,n){if(!t.name)throw new m("Cached content must contain a `name` field.");if(!t.model)throw new m("Cached content must contain a `model` field.");const o=["model","systemInstruction"];for(const n of o)if((null==e?void 0:e[n])&&t[n]&&(null==e?void 0:e[n])!==t[n]){if("model"===n&&(e.model.startsWith("models/")?e.model.replace("models/",""):e.model)===(t.model.startsWith("models/")?t.model.replace("models/",""):t.model))continue;throw new m(`Different value for "${n}" specified in modelParams (${e[n]}) and cachedContent (${t[n]})`)}const r=Object.assign(Object.assign({},e),{model:t.model,tools:t.tools,toolConfig:t.toolConfig,systemInstruction:t.systemInstruction,cachedContent:t});return new H(this.apiKey,r,n)}}("AIzaSyBQMXciQOFT5KF7aHpspY4AXBrTLUbxvS4").getGenerativeModel({model:"gemini-1.5-flash-8b"});function rt(){return st.apply(this,arguments)}function st(){return(st=tt(Q().mark((function t(){var e,n,o;return Q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("summarize loaded"),nt&&""!==nt.trim()){t.next=4;break}return console.error("No transcript available to summarize."),t.abrupt("return");case 4:return e="Summarise the content in keypoints so that a student can understand the concepts by just reading your summary and not watching the video:\n\n"+nt,t.prev=5,t.next=8,ot.generateContent(e);case 8:return n=t.sent,o=n.response.text(),t.abrupt("return",o);case 13:t.prev=13,t.t0=t.catch(5),console.error("Error generating summary:",t.t0);case 16:case"end":return t.stop()}}),t,null,[[5,13]])})))).apply(this,arguments)}function it(){return at.apply(this,arguments)}function at(){return(at=tt(Q().mark((function t(){var e,n,o;return Q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("summarize loaded"),nt&&""!==nt.trim()){t.next=4;break}return console.error("No transcript available to summarize."),t.abrupt("return");case 4:return e="Provide me with 10 multiple choice questions about this video. Return your answer entirely in the form of a JSON object. The JSON object should have a key named 'questions' which is an array of the questions. Each quiz question should include the choices, the answer, and a brief explanation of why the answer is correct. Don't include anything other than the JSON. The JSON properties of each question should be 'query', 'choices', 'answer', and 'explanation. The choices shouldn't have any ordinal value like A, B, C, D or a number like 1,2,3,4.  The answer should be the 0-indexed number of the correct choice.\n\n"+nt,t.prev=5,t.next=8,ot.generateContent(e);case 8:return n=t.sent,o=n,t.abrupt("return",o);case 13:t.prev=13,t.t0=t.catch(5),console.error("Error generating quiz:",quiz);case 16:case"end":return t.stop()}}),t,null,[[5,13]])})))).apply(this,arguments)}chrome.runtime.onMessage.addListener(function(){var t=tt(Q().mark((function t(e,n,o){var r,s,i,a,c;return Q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.type,s=e.videoID,console.log("Transcript function started"),"NEW"!==r){t.next=26;break}return et=s,t.prev=4,t.next=7,X.fetchTranscript(s);case 7:return i=t.sent,nt=i.map((function(t){return t.text})).join(" "),console.log("Transcript fetched:",nt),chrome.storage.sync.set((n={},l=nt,(u=function(t){var e=function(t){if("object"!=W(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==W(e)?e:e+""}(u=et))in n?Object.defineProperty(n,u,{value:l,enumerable:!0,configurable:!0,writable:!0}):n[u]=l,n)),t.next=13,rt();case 13:return a=t.sent,console.log("Summary generated:",a),t.next=17,it();case 17:c=t.sent,console.log("Quiz Generated:",c),o({summary:a,quiz:c}),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(4),console.error("Error fetching transcript or processing:",t.t0),o({error:"Failed to process transcript."});case 26:return t.abrupt("return",!0);case 27:case"end":return t.stop()}var n,u,l}),t,null,[[4,22]])})));return function(e,n,o){return t.apply(this,arguments)}}())})();
